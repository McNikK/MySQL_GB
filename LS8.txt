# 1. считаем количество у кого больше количество лайков (мужчин или женщин)

SELECT 
	profiles.gender, 
	COUNT(gender) as total_likes_by_gender
	FROM profiles
	JOIN likes
		ON
			profiles.user_id = likes.user_id
			AND likes.target_type_id = 2
GROUP BY 
	profiles.gender;

# 2. Подсчитать общее количество лайков, которые получили 10 самых молодых пользователей. \\не смогу подсчитать общую 
#сумму лайков


SELECT 
	profiles.user_id,	
	profiles.birthday,
	SUM(likes.target_id) as sum_for_yongest
	FROM profiles
	JOIN likes
		ON profiles.user_id = likes.user_id
		AND likes.target_type_id = 2
	GROUP BY profiles.user_id
	ORDER BY profiles.birthday
	LIMIT 10
;

#3. Найти 10 пользователей, которые проявляют наименьшую активность в использовании социальной сети.

SELECT 
	CONCAT(users.first_name, ' ', users.last_name) AS user,
	(COUNT(likes.target_id) + COUNT(media.id) + COUNT(messages.from_user_id)) AS overall_activity
	FROM users
	JOIN likes
		ON likes.user_id = users.id
	LEFT JOIN media
		ON media.user_id = users.id
	LEFT JOIN messages
		ON messages.from_user_id = users.id
	GROUP by user
	ORDER BY overall_activity
	LIMIT 10
;